# .ebextensions/08-http-force.config
files:
  "/etc/httpd/conf.d/zzz_elasticbeanstalk_override.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      <VirtualHost *:80>
        DocumentRoot /var/www/html/public
        <Directory /var/www/html/public>
          AllowOverride All
          Require all granted
          Options -Indexes +FollowSymLinks
        </Directory>
        
        # Headers para móviles y caché
        Header always set Cache-Control "no-cache, no-store, must-revalidate"
        Header always set Pragma "no-cache"
        Header always set Expires "0"
        Header always set X-Content-Type-Options "nosniff"
        Header always set X-Frame-Options "DENY"
        Header always set X-XSS-Protection "1; mode=block"
        Header always set Strict-Transport-Security "max-age=0; includeSubDomains"
      </VirtualHost>

container_commands:
  01_test_apache_config:
    command: "httpd -t"
    ignoreErrors: false
  02_restart_apache:
    command: "systemctl restart httpd"
    ignoreErrors: true